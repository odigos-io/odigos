# Workload State Assertions - Only for the 4 workloads in this test
# Verifies deployment state changes after instrumentation

# nodejs-minimum-version should be restarted (supported version)
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    deployment.kubernetes.io/revision: '2' # deployment spec changed when odigos resource was added
  generation: 2 # deployment spec changed when odigos resource was added
  labels:
    app: nodejs-minimum-version
  name: nodejs-minimum-version
  namespace: default
spec:
  selector:
    matchLabels:
      app: nodejs-minimum-version
status:
  availableReplicas: 1
  observedGeneration: 2 # deployment spec changed when odigos resource was added
  readyReplicas: 1
  replicas: 1
  updatedReplicas: 1
---
# nodejs-latest-version should be restarted (supported version)
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    deployment.kubernetes.io/revision: '2' # deployment spec changed when odigos resource was added
  generation: 2 # deployment spec changed when odigos resource was added
  labels:
    app: nodejs-latest-version
  name: nodejs-latest-version
  namespace: default
spec:
  selector:
    matchLabels:
      app: nodejs-latest-version
status:
  availableReplicas: 1
  observedGeneration: 2 # deployment spec changed when odigos resource was added
  readyReplicas: 1
  replicas: 1
  updatedReplicas: 1
---
# java-supported-version should be restarted (supported version)
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    deployment.kubernetes.io/revision: '2' # deployment spec changed when odigos resource was added
  generation: 2 # deployment spec changed when odigos resource was added
  labels:
    app: java-supported-version
  name: java-supported-version
  namespace: default
spec:
  selector:
    matchLabels:
      app: java-supported-version
status:
  availableReplicas: 1
  observedGeneration: 2 # deployment spec changed when odigos resource was added
  readyReplicas: 1
  replicas: 1
  updatedReplicas: 1
---
# python-latest-version should be restarted (supported version)
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    deployment.kubernetes.io/revision: '2' # deployment spec changed when odigos resource was added
  generation: 2 # deployment spec changed when odigos resource was added
  labels:
    app: python-latest-version
  name: python-latest-version
  namespace: default
spec:
  selector:
    matchLabels:
      app: python-latest-version
status:
  availableReplicas: 1
  observedGeneration: 2 # deployment spec changed when odigos resource was added
  readyReplicas: 1
  replicas: 1
  updatedReplicas: 1

package graph

// This file will be automatically regenerated based on the schema, any resolver implementations
// will be copied through when generating and any unknown code will be moved to the end.
// Code generated by github.com/99designs/gqlgen version v0.17.70

import (
	"context"

	"github.com/odigos-io/odigos/frontend/graph/model"
	"github.com/odigos-io/odigos/frontend/services"
)

// UpdateLocalUISamplingConfig is the resolver for the updateLocalUiSamplingConfig field.
func (r *mutationResolver) UpdateLocalUISamplingConfig(ctx context.Context, config *model.SamplingConfigInput) (bool, error) {
	samplingConfig := convertSamplingConfigInputToOdigosConfig(config)
	err := services.PersistUiLocalSamplingConfig(ctx, r.K8sCacheClient, samplingConfig)
	if err != nil {
		return false, err
	}
	return true, nil
}

// Sampling is the resolver for the sampling field.
func (r *queryResolver) Sampling(ctx context.Context) (*model.Sampling, error) {
	return &model.Sampling{
		Configs: &model.SamplingConfigs{},
	}, nil
}

// Effective is the resolver for the effective field.
func (r *samplingConfigsResolver) Effective(ctx context.Context, obj *model.SamplingConfigs) (*model.SamplingConfig, error) {
	config, err := services.GetEffectiveConfig(ctx, r.K8sCacheClient)
	if err != nil {
		return nil, err
	}
	return convertOdigosConfigToSamplingConfig(config), nil
}

// HelmDeployment is the resolver for the helmDeployment field.
func (r *samplingConfigsResolver) HelmDeployment(ctx context.Context, obj *model.SamplingConfigs) (*model.SamplingConfig, error) {
	config, err := services.GetHelmDeploymentConfig(ctx, r.K8sCacheClient)
	if err != nil {
		return nil, err
	}
	return convertOdigosConfigToSamplingConfig(config), nil
}

// RemoteConfigFromCentral is the resolver for the remoteConfigFromCentral field.
func (r *samplingConfigsResolver) RemoteConfigFromCentral(ctx context.Context, obj *model.SamplingConfigs) (*model.SamplingConfig, error) {
	config, err := services.GetRemoteConfig(ctx, r.K8sCacheClient)
	if err != nil {
		return nil, err
	}
	return convertOdigosConfigToSamplingConfig(config), nil
}

// LocalUIConfig is the resolver for the localUiConfig field.
func (r *samplingConfigsResolver) LocalUIConfig(ctx context.Context, obj *model.SamplingConfigs) (*model.SamplingConfig, error) {
	config, err := services.GetLocalUIConfig(ctx, r.K8sCacheClient)
	if err != nil {
		return nil, err
	}
	return convertOdigosConfigToSamplingConfig(config), nil
}

// SamplingConfigs returns SamplingConfigsResolver implementation.
func (r *Resolver) SamplingConfigs() SamplingConfigsResolver { return &samplingConfigsResolver{r} }

type samplingConfigsResolver struct{ *Resolver }

apiVersion: odigos.io/v1alpha1
kind: Processor
metadata:
  name: category-attributes
spec:
  type: transform
  processorName: "category attributes"
  notes: "Auto generated rule from category-attributes profile. Do not edit."
  processorConfig:
    trace_statements:
      - context: span
        statements:

        ######## Node.js

        # HTTP
        - set(attributes["odigos.category"], "HTTP") where 
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-connect" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-express" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-fastify" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-hapi" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-http" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-koa" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-restify" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-router" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-nestjs-core" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-undici"
        - set(attributes["odigos.sub_category"], attributes["http.request.method"]) where 
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-connect" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-express" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-fastify" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-hapi" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-http" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-koa" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-restify" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-router" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-nestjs-core" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-undici"
        - set(attributes["odigos.sub_category"], attributes["http.method"]) where 
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-connect" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-express" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-fastify" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-hapi" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-http" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-koa" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-restify" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-router" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-nestjs-core" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-undici"
        - set(attributes["odigos.transaction.type"], "web") where 
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-connect" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-express" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-fastify" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-hapi" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-http" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-koa" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-restify" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-router" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-nestjs-core" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-undici"            

        # Database
        - set(attributes["odigos.category"], "Database") where 
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-cassandra-driver" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-ioredis" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-knex" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-mongodb" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-mongoose" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-mysql" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-mysql2" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-pg" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-redis" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-redis-4" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-tedious"
        - set(attributes["odigos.sub_category"], attributes["db.system"]) where 
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-cassandra-driver" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-ioredis" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-knex" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-mongodb" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-mongoose" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-mysql" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-mysql2" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-pg" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-redis" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-redis-4" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-tedious"
        - set(attributes["odigos.transaction.type"], "non-web") where 
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-cassandra-driver" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-ioredis" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-knex" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-mongodb" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-mongoose" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-mysql" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-mysql2" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-pg" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-redis" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-redis-4" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-tedious"            

        # Messaging queues
        - set(attributes["odigos.category"], "Messaging queues") where 
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-amqplib" or 
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-socket.io"
        - set(attributes["odigos.sub_category"], attributes["messaging.system"]) where 
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-amqplib" or 
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-socket.io"
        - set(attributes["odigos.transaction.type"], "non-web") where 
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-amqplib" or 
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-socket.io"            

        # RPC Systems
        - set(attributes["odigos.category"], "RPC Systems") where 
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-aws-sdk" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-grpc"
        - set(attributes["odigos.sub_category"], attributes["rpc.system"]) where 
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-aws-sdk" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-grpc"
        - set(attributes["odigos.transaction.type"], "web") where 
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-aws-sdk" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-grpc"

        # Programming Language
        - set(attributes["odigos.category"], "Programming Language") where 
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-dataloader" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-dns" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-fs" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-generic-pool" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-graphql" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-lru-memoizer" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-net"
        - set(attributes["odigos.sub_category"], attributes["telemetry.sdk.language"]) where 
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-dataloader" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-dns" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-fs" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-generic-pool" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-graphql" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-lru-memoizer" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-net"
        - set(attributes["odigos.transaction.type"], "non-web") where 
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-dataloader" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-dns" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-fs" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-generic-pool" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-graphql" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-lru-memoizer" or
            instrumentation_scope.name == "odigos.io/ebpf/instrumentation-net"            

        ######## golang

        # HTTP
        - set(attributes["odigos.category"], "HTTP") where 
            instrumentation_scope.name == "go.opentelemetry.io/auto/net/http" or
            instrumentation_scope.name == "go.opentelemetry.io/auto/github.com/gin-gonic/gin"
        - set(attributes["odigos.sub_category"], attributes["http.request.method"]) where
            instrumentation_scope.name == "go.opentelemetry.io/auto/net/http" or
            instrumentation_scope.name == "go.opentelemetry.io/auto/github.com/gin-gonic/gin"
        - set(attributes["odigos.transaction.type"], "web") where
            instrumentation_scope.name == "go.opentelemetry.io/auto/net/http" or
            instrumentation_scope.name == "go.opentelemetry.io/auto/github.com/gin-gonic/gin"            

        # Database
        - set(attributes["odigos.category"], "Database") where 
            instrumentation_scope.name == "go.opentelemetry.io/auto/database/sql" or
            instrumentation_scope.name == "go.opentelemetry.io/auto/github.com/bradfitz/gomemcache/memcache" or
            instrumentation_scope.name == "go.opentelemetry.io/auto/github.com/elastic/go-elasticsearch" or
            instrumentation_scope.name == "go.opentelemetry.io/auto/github.com/gocql/gocql" or
            IsMatch(instrumentation_scope.name, "go.opentelemetry.io/auto/github.com/ClickHouse/clickhouse-go/*")

        - set(attributes["odigos.sub_category"], attributes["db.system"]) where
            instrumentation_scope.name == "go.opentelemetry.io/auto/database/sql" or
            instrumentation_scope.name == "go.opentelemetry.io/auto/github.com/bradfitz/gomemcache/memcache" or
            instrumentation_scope.name == "go.opentelemetry.io/auto/github.com/elastic/go-elasticsearch" or
            instrumentation_scope.name == "go.opentelemetry.io/auto/github.com/gocql/gocql" or 
            IsMatch(instrumentation_scope.name, "go.opentelemetry.io/auto/github.com/ClickHouse/clickhouse-go/*")

        - set(attributes["odigos.transaction.type"], "non-web") where
            instrumentation_scope.name == "go.opentelemetry.io/auto/database/sql" or
            instrumentation_scope.name == "go.opentelemetry.io/auto/github.com/bradfitz/gomemcache/memcache" or
            instrumentation_scope.name == "go.opentelemetry.io/auto/github.com/elastic/go-elasticsearch" or
            instrumentation_scope.name == "go.opentelemetry.io/auto/github.com/gocql/gocql" or 
            IsMatch(instrumentation_scope.name, "go.opentelemetry.io/auto/github.com/ClickHouse/clickhouse-go/*")

        # Messaging queues
        - set(attributes["odigos.category"], "Messaging queues") where 
            instrumentation_scope.name == "go.opentelemetry.io/auto/github.com/segmentio/kafka-go" or 
            instrumentation_scope.name == "go.opentelemetry.io/auto/github.com/IBM/sarama" or 
            instrumentation_scope.name == "go.opentelemetry.io/auto/github.com/rabbitmq/amqp091-go" or 
            instrumentation_scope.name == "go.opentelemetry.io/auto/github.com/apache/pulsar-client-go/pulsar"
        - set(attributes["odigos.sub_category"], attributes["messaging.system"]) where
            instrumentation_scope.name == "go.opentelemetry.io/auto/github.com/segmentio/kafka-go" or 
            instrumentation_scope.name == "go.opentelemetry.io/auto/github.com/IBM/sarama" or 
            instrumentation_scope.name == "go.opentelemetry.io/auto/github.com/rabbitmq/amqp091-go" or 
            instrumentation_scope.name == "go.opentelemetry.io/auto/github.com/apache/pulsar-client-go/pulsar"
        - set(attributes["odigos.transaction.type"], "non-web") where
            instrumentation_scope.name == "go.opentelemetry.io/auto/github.com/segmentio/kafka-go" or 
            instrumentation_scope.name == "go.opentelemetry.io/auto/github.com/IBM/sarama" or 
            instrumentation_scope.name == "go.opentelemetry.io/auto/github.com/rabbitmq/amqp091-go" or 
            instrumentation_scope.name == "go.opentelemetry.io/auto/github.com/apache/pulsar-client-go/pulsar"            

        # RPC Systems
        - set(attributes["odigos.category"], "RPC Systems") where 
            instrumentation_scope.name == "go.opentelemetry.io/auto/google.golang.org/grpc"
        - set(attributes["odigos.sub_category"], attributes["rpc.system"]) where
            instrumentation_scope.name == "go.opentelemetry.io/auto/google.golang.org/grpc"
        - set(attributes["odigos.transaction.type"], "web") where
            instrumentation_scope.name == "go.opentelemetry.io/auto/google.golang.org/grpc"        

        ######## Python

        # HTTP
        - set(attributes["odigos.category"], "HTTP") where 
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/aiohttp_client" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/asgi" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/boto" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/django" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/falcon" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/fastapi" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/flask" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/httpx" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/pyramid" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/starlette" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/tornado" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/urllib" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/requests" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/urllib3" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/wsgi"
        - set(attributes["odigos.sub_category"], attributes["http.method"]) where 
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/aiohttp_client" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/asgi" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/boto" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/django" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/falcon" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/fastapi" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/flask" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/httpx" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/pyramid" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/starlette" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/tornado" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/urllib" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/requests" or            
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/urllib3" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/wsgi" 
        - set(attributes["odigos.sub_category"], attributes["http.request.method"]) where
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/aiohttp_client" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/asgi" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/boto" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/django" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/falcon" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/fastapi" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/flask" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/httpx" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/pyramid" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/starlette" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/tornado" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/urllib" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/requests" or            
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/urllib3" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/wsgi"
        - set(attributes["odigos.transaction.type"], "web") where
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/aiohttp_client" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/asgi" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/boto" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/django" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/falcon" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/fastapi" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/flask" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/httpx" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/pyramid" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/starlette" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/tornado" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/urllib" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/urllib3" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/requests" or            
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/wsgi"            

        # Database
        - set(attributes["odigos.category"], "Database") where 
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/aiopg" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/asyncpg" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/cassandra" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/dbapi" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/elasticsearch" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/mysql" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/mysqlclient" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/psycopg2" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/pymemcache" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/pymongo" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/pymysql" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/redis" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/sqlalchemy" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/sqlite3" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/tortoiseorm"
        - set(attributes["odigos.sub_category"], attributes["db.system"]) where
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/aiopg" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/asyncpg" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/cassandra" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/dbapi" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/elasticsearch" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/mysql" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/mysqlclient" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/psycopg2" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/pymemcache" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/pymongo" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/pymysql" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/redis" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/sqlalchemy" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/sqlite3" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/tortoiseorm"
        - set(attributes["odigos.transaction.type"], "non-web") where
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/aiopg" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/asyncpg" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/cassandra" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/dbapi" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/elasticsearch" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/mysql" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/mysqlclient" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/psycopg2" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/pymemcache" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/pymongo" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/pymysql" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/redis" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/sqlalchemy" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/sqlite3" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/tortoiseorm"

        # Messaging queues
        - set(attributes["odigos.category"], "Messaging queues") where 
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/aio_pika" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/boto3sqs" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/celery" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/confluent_kafka" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/kafka" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/pika" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/remoulade"
        - set(attributes["odigos.sub_category"], attributes["messaging.system"]) where
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/aio_pika" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/boto3sqs" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/celery" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/confluent_kafka" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/kafka" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/pika" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/remoulade"
        - set(attributes["odigos.transaction.type"], "non-web") where
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/aio_pika" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/boto3sqs" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/celery" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/confluent_kafka" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/kafka" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/pika" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/remoulade"

        # RPC Systems
        - set(attributes["odigos.category"], "RPC Systems") where 
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/botocore" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/grpc"
        - set(attributes["odigos.sub_category"], attributes["rpc.system"]) where
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/botocore" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/grpc"
        - set(attributes["odigos.transaction.type"], "web") where
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/botocore" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/grpc"            

        # Programming Language
        - set(attributes["odigos.category"], "Programming Language") where 
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/asyncio" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/jinja2" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/sklearn"
        - set(attributes["odigos.sub_category"], attributes["telemetry.sdk.language"]) where
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/asyncio" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/jinja2" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/sklearn"
        - set(attributes["odigos.transaction.type"], "non-web") where
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/asyncio" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/jinja2" or
            instrumentation_scope.name == "instrumentation.odigos.io/ebpf/sklearn"            

          ######## Java

          # HTTP
        - set(attributes["odigos.category"], "HTTP") where
            IsMatch(instrumentation_scope.name, "io.opentelemetry.tomcat-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.akka*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.apache-httpclient*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.apache-httpasyncclient*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.armeria*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.google-http-client-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.grizzly-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.http-url-connection*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.java-http-client*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.jetty-httpclient-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.okhttp-*")

        - set(attributes["odigos.sub_category"], attributes["http.method"]) where
            IsMatch(instrumentation_scope.name, "io.opentelemetry.tomcat-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.akka*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.apache-httpclient*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.apache-httpasyncclient*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.armeria*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.google-http-client-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.grizzly-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.http-url-connection*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.java-http-client*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.jetty-httpclient-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.okhttp-*")

        - set(attributes["odigos.sub_category"], attributes["http.request.method"]) where
            IsMatch(instrumentation_scope.name, "io.opentelemetry.tomcat-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.akka*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.apache-httpclient*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.apache-httpasyncclient*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.armeria*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.google-http-client-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.grizzly-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.http-url-connection*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.java-http-client*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.jetty-httpclient-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.okhttp-*")

        - set(attributes["odigos.transaction.type"], "web") where
            IsMatch(instrumentation_scope.name, "io.opentelemetry.tomcat-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.akka*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.apache-httpclient*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.apache-httpasyncclient*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.armeria*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.google-http-client-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.grizzly-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.http-url-connection*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.java-http-client*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.jetty-httpclient-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.okhttp-*")            

          # RPC Systems
        - set(attributes["odigos.category"], "RPC Systems") where
            IsMatch(instrumentation_scope.name, "io.opentelemetry.apache-dubbo-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.grpc-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.rmi*")

        - set(attributes["odigos.sub_category"], attributes["rpc.system"]) where
            IsMatch(instrumentation_scope.name, "io.opentelemetry.apache-dubbo-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.grpc-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.rmi*")

        - set(attributes["odigos.transaction.type"], "web") where
            IsMatch(instrumentation_scope.name, "io.opentelemetry.apache-dubbo-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.grpc-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.rmi*")            

          # SOAP
        - set(attributes["odigos.category"], "SOAP") where
            IsMatch(instrumentation_scope.name, "io.opentelemetry.apache-dubbo-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.jaxws-*")
        - set(attributes["odigos.transaction.type"], "non-web") where
            IsMatch(instrumentation_scope.name, "io.opentelemetry.apache-dubbo-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.jaxws-*")            

          # REST
        - set(attributes["odigos.category"], "REST") where
            IsMatch(instrumentation_scope.name, "io.opentelemetry.jaxrs-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.quarkus-resteasy-reactive*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.restlet-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.opensearch-rest-*")

        - set(attributes["odigos.transaction.type"], "web") where
            IsMatch(instrumentation_scope.name, "io.opentelemetry.jaxrs-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.quarkus-resteasy-reactive*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.restlet-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.opensearch-rest-*")            

          # Messaging queues
        - set(attributes["odigos.category"], "Messaging queues") where
            IsMatch(instrumentation_scope.name, "io.opentelemetry.rocketmq-client-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.spring-jms-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.jms-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.kafka-clients-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.kafka-streams-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.reactor-kafka-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.spring-kafka-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.vertx-kafka-client-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.rabbitmq-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.spring-rabbit-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.netty-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.reactor-netty-*")

        - set(attributes["odigos.sub_category"], attributes["messaging.system"]) where
            IsMatch(instrumentation_scope.name, "io.opentelemetry.rocketmq-client-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.spring-jms-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.jms-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.kafka-clients-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.kafka-streams-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.reactor-kafka-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.spring-kafka-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.vertx-kafka-client-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.rabbitmq-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.spring-rabbit-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.netty-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.reactor-netty-*")

        - set(attributes["odigos.transaction.type"], "non-web") where
            IsMatch(instrumentation_scope.name, "io.opentelemetry.rocketmq-client-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.spring-jms-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.jms-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.kafka-clients-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.kafka-streams-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.reactor-kafka-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.spring-kafka-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.vertx-kafka-client-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.rabbitmq-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.spring-rabbit-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.netty-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.reactor-netty-*")            


          # Web Framework
        - set(attributes["odigos.category"], "Web Framework") where
            IsMatch(instrumentation_scope.name, "io.opentelemetry.wicket-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.tapestry-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.dropwizard-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.finatra-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.grails-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.gwt-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.jsp-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.jsf-mojarra-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.jsf-myfaces-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.play-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.ratpack-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.servlet-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.spark-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.spring-web*")

        - set(attributes["odigos.sub_category"], "framework-core-components") where
            IsMatch(instrumentation_scope.name, "io.opentelemetry.wicket-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.tapestry-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.dropwizard-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.finatra-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.grails-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.gwt-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.jsp-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.jsf-mojarra-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.jsf-myfaces-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.play-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.ratpack-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.servlet-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.spark-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.spring-web*")

        - set(attributes["odigos.transaction.type"], "web") where
            IsMatch(instrumentation_scope.name, "io.opentelemetry.wicket-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.tapestry-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.dropwizard-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.finatra-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.grails-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.gwt-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.jsp-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.jsf-mojarra-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.jsf-myfaces-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.play-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.ratpack-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.servlet-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.spark-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.spring-web*")            

          # Serverless
        - set(attributes["odigos.category"], "Serverless") where
            IsMatch(instrumentation_scope.name, "io.opentelemetry.aws-lambda-*")
        - set(attributes["odigos.transaction.type"], "non-web") where
            IsMatch(instrumentation_scope.name, "io.opentelemetry.aws-lambda-*")            

          # Database
        - set(attributes["odigos.category"], "Database") where
            IsMatch(instrumentation_scope.name, "io.opentelemetry.cassandra-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.couchbase-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.geode-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.mongo-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.jdbc*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.lettuce-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.jedis-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.Rediscala-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.redisson-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.vertx-redis-client-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.hibernate-*")

        - set(attributes["odigos.sub_category"], attributes["db.system"]) where
            IsMatch(instrumentation_scope.name, "io.opentelemetry.cassandra-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.couchbase-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.geode-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.mongo-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.jdbc*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.lettuce-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.jedis-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.Rediscala-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.redisson-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.vertx-redis-client-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.hibernate-*")

        - set(attributes["odigos.transaction.type"], "non-web") where
            IsMatch(instrumentation_scope.name, "io.opentelemetry.cassandra-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.couchbase-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.geode-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.mongo-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.jdbc*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.lettuce-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.jedis-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.Rediscala-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.redisson-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.vertx-redis-client-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.hibernate-*")

          # Logging
        - set(attributes["odigos.category"], "Log") where
            IsMatch(instrumentation_scope.name, "io.opentelemetry.log4j-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.logback-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.internal-application-logger") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.java-util-logging") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.jboss-logmanager-*")
        - set(attributes["odigos.transaction.type"], "non-web") where
            IsMatch(instrumentation_scope.name, "io.opentelemetry.log4j-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.logback-*") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.internal-application-logger") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.java-util-logging") or
            IsMatch(instrumentation_scope.name, "io.opentelemetry.jboss-logmanager-*")            


          # Kubernetes
        - set(attributes["odigos.category"], "Kubernetes") where
            IsMatch(instrumentation_scope.name, "io.opentelemetry.kubernetes-client-*")

        - set(attributes["odigos.transaction.type"], "non-web") where
            IsMatch(instrumentation_scope.name, "io.opentelemetry.kubernetes-client-*")            


          # Search Engine
        - set(attributes["odigos.category"], "Search Engine") where
            IsMatch(instrumentation_scope.name, "io.opentelemetry.elasticsearch-*")

        - set(attributes["odigos.transaction.type"], "non-web") where
            IsMatch(instrumentation_scope.name, "io.opentelemetry.elasticsearch-*")


  signals:
    - TRACES
  collectorRoles:
    - CLUSTER_GATEWAY
    